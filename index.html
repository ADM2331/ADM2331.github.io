<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Undangan Pernikahan Yuliana & Herdiman</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --dusty-rose: #D4A5A5;
            --dusty-rose-light: #F0DCDC;
            --dusty-rose-dark: #A17B7B;
            --text-color: #333;
        }

        body {
            font-family: 'Inter', sans-serif;
            color: var(--text-color);
            background-color: #fff;
            overflow-x: hidden;
        }

        .font-playfair {
            font-family: 'Playfair Display', serif;
        }

        .bg-dusty-rose {
            background-color: var(--dusty-rose);
        }

        .text-dusty-rose-dark {
            color: var(--dusty-rose-dark);
        }

        .border-dusty-rose {
            border-color: var(--dusty-rose);
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-thumb {
            background-color: var(--dusty-rose-dark);
            border-radius: 4px;
        }
        ::-webkit-scrollbar-track {
            background-color: var(--dusty-rose-light);
        }

        /* Hero image background */
        .hero-section {
            background-image: url('https://lh3.googleusercontent.com/d/1cnujpIj4EjHeX-NvcvZDhSQyVurXtg7C?authuser=0');
            background-size: cover;
            background-position: center;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            animation: fadeIn 2s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Smooth scroll effect for sections */
        .section {
            transition: opacity 1s ease-in-out, transform 1s ease-in-out;
            opacity: 0;
            transform: translateY(20px);
        }

        .section.is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Parallax effect for text */
        .parallax-text {
            transform: translateY(0);
            transition: transform 0.5s ease-out;
        }
        
        .shadow-custom {
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        /* Music button animation */
        .music-button {
            transition: transform 0.3s ease-in-out;
        }
        .music-button:hover {
            transform: scale(1.1);
        }
        
        /* RSVP & Gift button styles */
        .btn-primary {
            @apply px-6 py-3 rounded-full text-white bg-dusty-rose-dark shadow-md transition-all duration-300 hover:bg-dusty-rose-dark/80 hover:shadow-lg;
        }
        
        .btn-secondary {
            @apply px-6 py-3 rounded-full text-dusty-rose-dark border border-dusty-rose-dark transition-all duration-300 hover:bg-dusty-rose-dark hover:text-white;
        }
    </style>
</head>
<body class="bg-gray-50">

    <!-- Musik & Navigasi -->
    <div id="music-player" class="fixed bottom-4 right-4 z-50">
        <button id="music-toggle" class="music-button p-3 rounded-full bg-white shadow-lg border border-dusty-rose-dark">
            <svg id="play-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-dusty-rose-dark" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010.28 9v6a1 1 0 001.275.812l3.197-2.132a1 1 0 000-1.624z" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <svg id="pause-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-dusty-rose-dark hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        </button>
        <audio id="background-music" loop>
            <source src="https://raw.githubusercontent.com/ADM2331/audio-web/main/echoofsadness.mp3" type="audio/mp3">
        </audio>
    </div>

    <!-- Hero Section -->
    <header id="hero" class="hero-section text-white text-center shadow-inner">
        <div class="absolute inset-0 bg-black bg-opacity-30"></div>
        <div class="relative z-10 p-8 md:p-12">
            <h1 class="text-4xl md:text-6xl font-playfair italic font-bold tracking-wide animate-pulse">Yuliana & Herdiman</h1>
            <p class="text-xl md:text-2xl mt-4 font-inter font-light">
                5 Oktober 2025
            </p>
        </div>
    </header>

    <!-- About Us Section -->
    <section id="about" class="section py-16 md:py-24 px-4 container mx-auto text-center">
        <h2 class="text-3xl md:text-5xl font-playfair text-dusty-rose-dark font-bold mb-4">Cerita Cinta Kami</h2>
        <p class="text-lg md:text-xl max-w-2xl mx-auto leading-relaxed mt-8">
            Di pagi hari yang begitu indah saya mendengar kicuan burung biru di atas pohon durian, dibawah pohon itu saya bersiul gembira seakan ada suatu hal besar yang sudah disiapakan alam semesta untuk ku. benar saja, tak lama waktu berlalu datanglah saiful sang pujaan hatiku di arah depan. aku terkaget sekan itu adalah mimpi yang siap menjebak dan menghancurkanku ketika bangun tetapi tidak, itu benar saiful aku tidak sedang bermimpi. tak seperti kisah Newton yang menemukan gravitasi ketika tertimpa buah apel akupun berbeda, aku menemukan saiful ketika buah durian sebesar bola voli jatuh menimpa kepalaku. dan hari itulah saksi pertemuan kami berdua Herdiman Love Saiful
        </p>
    </section>

    <!-- Countdown Timer -->
    <section id="countdown" class="section bg-dusty-rose-light py-16 px-4 text-center">
        <h2 class="text-3xl md:text-5xl font-playfair text-dusty-rose-dark font-bold mb-8">Menuju Hari Bahagia</h2>
        <div id="countdown-timer" class="flex justify-center space-x-4 md:space-x-8 text-dusty-rose-dark">
            <div class="bg-white p-4 md:p-6 rounded-lg shadow-md w-24 md:w-32">
                <div id="days" class="text-4xl md:text-6xl font-bold font-playfair">0</div>
                <div class="text-sm md:text-base mt-2">Hari</div>
            </div>
            <div class="bg-white p-4 md:p-6 rounded-lg shadow-md w-24 md:w-32">
                <div id="hours" class="text-4xl md:text-6xl font-bold font-playfair">0</div>
                <div class="text-sm md:text-base mt-2">Jam</div>
            </div>
            <div class="bg-white p-4 md:p-6 rounded-lg shadow-md w-24 md:w-32">
                <div id="minutes" class="text-4xl md:text-6xl font-bold font-playfair">0</div>
                <div class="text-sm md:text-base mt-2">Menit</div>
            </div>
            <div class="bg-white p-4 md:p-6 rounded-lg shadow-md w-24 md:w-32">
                <div id="seconds" class="text-4xl md:text-6xl font-bold font-playfair">0</div>
                <div class="text-sm md:text-base mt-2">Detik</div>
            </div>
        </div>
    </section>

    <!-- Details Acara Section -->
    <section id="details" class="section py-16 md:py-24 px-4 container mx-auto text-center">
        <h2 class="text-3xl md:text-5xl font-playfair text-dusty-rose-dark font-bold mb-8">Detail Acara</h2>
        <div class="flex flex-col md:flex-row justify-center items-center md:space-x-12 space-y-8 md:space-y-0">
            <!-- Akad Nikah -->
            <div class="bg-white p-8 rounded-lg shadow-lg max-w-sm w-full transition-all duration-300 hover:scale-105">
                <h3 class="text-xl md:text-2xl font-playfair font-bold text-dusty-rose-dark">Akad Nikah</h3>
                <p class="mt-4 text-lg">Minggu, 5 Oktober 2025</p>
                <p class="text-2xl font-bold mt-2 font-playfair">10:00 WITA</p>
                <p class="mt-4 text-sm md:text-base">
                    Lokasi: Bore, Des.Berinding, Kec.Kopang
                </p>
            </div>
            <!-- Resepsi -->
            <div class="bg-white p-8 rounded-lg shadow-lg max-w-sm w-full transition-all duration-300 hover:scale-105">
                <h3 class="text-xl md:text-2xl font-playfair font-bold text-dusty-rose-dark">Resepsi</h3>
                <p class="mt-4 text-lg">Minggu, 5 Oktober 2025</p>
                <p class="text-2xl font-bold mt-2 font-playfair">11:00 WITA</p>
                <p class="mt-4 text-sm md:text-base">
                    Lokasi: Bore, Des.Berinding, Kec.Kopang
                </p>
            </div>
        </div>
        <div class="mt-12">
            <h3 class="text-xl md:text-2xl font-playfair text-dusty-rose-dark font-bold mb-4">Lokasi Acara</h3>
            <div class="relative w-full h-80 rounded-lg overflow-hidden shadow-lg border border-dusty-rose">
                <iframe
                    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d15783.565158673756!2d116.32623348003612!3d-8.629457632688463!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2dcdb70d3e5272a5%3A0x64366a6b5790d965!2sBore%2C%20Des.%20Berinding%2C%20Kec.%20Kopang%2C%20Kabupaten%20Lombok%20Tengah%2C%20Nusa%20Tenggara%20Bar.%2083552!5e0!3m2!1sen!2sid!4v1699999999999!5m2!1sen!2sid"
                    width="100%"
                    height="100%"
                    style="border:0;"
                    allowfullscreen=""
                    loading="lazy"
                    referrerpolicy="no-referrer-when-downgrade">
                </iframe>
            </div>
        </div>
    </section>

    <!-- Galeri Section -->
    <section id="gallery" class="section bg-dusty-rose-light py-16 md:py-24 px-4 text-center">
        <h2 class="text-3xl md:text-5xl font-playfair text-dusty-rose-dark font-bold mb-8">Galeri Foto</h2>
        <div class="grid grid-cols-2 md:grid-cols-3 gap-4 md:gap-6 max-w-5xl mx-auto">
            <img src="https://lh3.googleusercontent.com/d/1QomSWgkxtz2g29POZiLQ3R32XO6M7bac?authuser=0" alt="Galeri Foto 1" class="w-full h-auto rounded-lg shadow-md object-cover transform transition-transform duration-300 hover:scale-105">
            <img src="https://lh3.googleusercontent.com/d/1aAHvv3RWAKhItdX1Jby6mxpFCB2Qooe1?authuser=0" alt="Galeri Foto 2" class="w-full h-auto rounded-lg shadow-md object-cover transform transition-transform duration-300 hover:scale-105">
            <img src="https://lh3.googleusercontent.com/d/1mJQo02E24WB0p4r4F7NgiZZQkPpaXJTn?authuser=0" alt="Galeri Foto 3" class="w-full h-auto rounded-lg shadow-md object-cover transform transition-transform duration-300 hover:scale-105">
            <img src="https://lh3.googleusercontent.com/d/1NM434vNUQJLG3ODs5Ovf5lEm0GLcM3Vu?authuser=0" alt="Galeri Foto 4" class="w-full h-auto rounded-lg shadow-md object-cover transform transition-transform duration-300 hover:scale-105">
            <img src="https://lh3.googleusercontent.com/d/1wMGT5QGOgBb0uQsCUg7I5Xn9RfSbexiY?authuser=0" alt="Galeri Foto 5" class="w-full h-auto rounded-lg shadow-md object-cover transform transition-transform duration-300 hover:scale-105">
            <img src="https://lh3.googleusercontent.com/d/1qZtfMreEh2dRec0YDQlwx5ZmFrKziMST?authuser=0" alt="Galeri Foto 6" class="w-full h-auto rounded-lg shadow-md object-cover transform transition-transform duration-300 hover:scale-105">
        </div>
    </section>

    <!-- RSVP & Guestbook Section -->
    <section id="guestbook" class="section py-16 md:py-24 px-4 container mx-auto text-center">
        <h2 class="text-3xl md:text-5xl font-playfair text-dusty-rose-dark font-bold mb-8">Buku Tamu</h2>
        <p class="text-lg md:text-xl max-w-2xl mx-auto leading-relaxed mt-4 mb-8">
            saya harap teman teman bisa hadir di hari yang paling berarti bagi saya ini
        </p>

        <!-- RSVP Form -->
        <div class="bg-white p-8 rounded-lg shadow-lg max-w-xl mx-auto border border-dusty-rose-light">
            <h3 class="text-xl md:text-2xl font-playfair font-bold text-dusty-rose-dark mb-4">Konfirmasi Kehadiran</h3>
            <form id="rsvp-form" class="space-y-4">
                <input type="text" id="nama-rsvp" placeholder="Nama Anda" required class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-dusty-rose-light">
                <select id="kehadiran" required class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-dusty-rose-light">
                    <option value="" disabled selected>Apakah Anda akan hadir?</option>
                    <option value="hadir">Hadir</option>
                    <option value="tidak-hadir">Tidak Hadir</option>
                </select>
                <textarea id="pesan-rsvp" placeholder="Pesan dan doa terbaik untuk kami..." rows="4" class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-dusty-rose-light"></textarea>
                <button type="submit" class="w-full btn-primary">Kirim</button>
            </form>
            <div id="rsvp-message" class="mt-4 text-sm font-semibold text-green-600 hidden">Terima kasih atas konfirmasi Anda!</div>
        </div>

        <!-- Guest Book List -->
        <div class="mt-12 bg-white p-8 rounded-lg shadow-lg max-w-xl mx-auto border border-dusty-rose-light">
            <h3 class="text-xl md:text-2xl font-playfair font-bold text-dusty-rose-dark mb-4">Ucapan & Doa</h3>
            <div id="guest-messages" class="space-y-4 text-left max-h-80 overflow-y-auto">
                <!-- Pesan dari tamu akan dimuat di sini oleh JS -->
            </div>
        </div>
    </section>
    
    <!-- Wedding Gift Section -->
    <section id="gift" class="section py-16 md:py-24 px-4 container mx-auto text-center">
        <h2 class="text-3xl md:text-5xl font-playfair text-dusty-rose-dark font-bold mb-8">Wedding Gift</h2>
        <div class="bg-white p-8 rounded-lg shadow-lg max-w-md mx-auto border border-dusty-rose-light">
            <p class="text-lg md:text-xl mb-4 font-playfair">Bagi yang ingin memberikan hadiah digital, silakan kirim ke rekening di bawah ini:</p>
            <p class="text-2xl md:text-3xl font-bold font-playfair mb-2 text-dusty-rose-dark">918199101012820</p>
            <p class="text-lg mb-4">An. Yuliana</p>
            <button id="copy-btn" class="btn-primary">Salin Nomor Rekening</button>
            <div id="copy-message" class="mt-4 text-sm font-semibold text-green-600 hidden">Nomor rekening berhasil disalin!</div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-dusty-rose py-8 text-center text-white">
        <p class="text-lg font-playfair italic">&copy; 2025 Undangan Pernikahan Yuliana & Herdiman</p>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot, orderBy, query } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // Atur log level untuk debugging
        setLogLevel('Debug');

        // Global variables provided by the environment
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
        
        let app;
        let db;
        let auth;
        let userId;

        // Initialize Firebase
        try {
            app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            auth = getAuth(app);

            onAuthStateChanged(auth, async (user) => {
                if (user) {
                    userId = user.uid;
                    console.log("User is signed in with UID:", userId);
                    loadGuestMessages();
                } else {
                    console.log("No user is signed in. Attempting to sign in anonymously.");
                    try {
                        if (initialAuthToken) {
                            const userCredential = await signInWithCustomToken(auth, initialAuthToken);
                            userId = userCredential.user.uid;
                            console.log("Signed in with custom token. UID:", userId);
                            loadGuestMessages();
                        } else {
                            await signInAnonymously(auth);
                            // The onAuthStateChanged listener will be called again with the new anonymous user
                        }
                    } catch (error) {
                        console.error("Firebase Auth Error:", error);
                    }
                }
            });
        } catch (error) {
            console.error("Failed to initialize Firebase:", error);
        }

        // Countdown Timer
        const weddingDate = new Date("2025-10-05T10:00:00").getTime();
        const countdownInterval = setInterval(function() {
            const now = new Date().getTime();
            const distance = weddingDate - now;

            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            if (document.getElementById("days")) {
                document.getElementById("days").innerHTML = days;
                document.getElementById("hours").innerHTML = hours;
                document.getElementById("minutes").innerHTML = minutes;
                document.getElementById("seconds").innerHTML = seconds;
            }

            if (distance < 0) {
                clearInterval(countdownInterval);
                document.getElementById("countdown-timer").innerHTML = "Kami Telah Menikah!";
            }
        }, 1000);

        // Music Player
        const musicToggle = document.getElementById('music-toggle');
        const backgroundMusic = document.getElementById('background-music');
        const playIcon = document.getElementById('play-icon');
        const pauseIcon = document.getElementById('pause-icon');

        musicToggle.addEventListener('click', () => {
            if (backgroundMusic.paused) {
                backgroundMusic.play();
                playIcon.classList.add('hidden');
                pauseIcon.classList.remove('hidden');
            } else {
                backgroundMusic.pause();
                playIcon.classList.remove('hidden');
                pauseIcon.classList.add('hidden');
            }
        });

        // Copy to clipboard
        const copyBtn = document.getElementById('copy-btn');
        const copyMessage = document.getElementById('copy-message');

        if (copyBtn) {
            copyBtn.addEventListener('click', () => {
                const rekening = '918199101012820';
                try {
                    const tempInput = document.createElement('input');
                    tempInput.value = rekening;
                    document.body.appendChild(tempInput);
                    tempInput.select();
                    document.execCommand('copy');
                    document.body.removeChild(tempInput);
                    copyMessage.classList.remove('hidden');
                    setTimeout(() => {
                        copyMessage.classList.add('hidden');
                    }, 2000);
                } catch (err) {
                    console.error('Failed to copy text: ', err);
                }
            });
        }

        // Intersection Observer for animations
        const sections = document.querySelectorAll('.section');
        const observerOptions = {
            root: null,
            rootMargin: '0px',
            threshold: 0.2
        };

        const observer = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-visible');
                } else {
                    entry.target.classList.remove('is-visible');
                }
            });
        }, observerOptions);

        sections.forEach(section => {
            observer.observe(section);
        });

        // Parallax effect on scroll
        window.addEventListener('scroll', () => {
            const parallaxText = document.querySelector('.parallax-text');
            if (parallaxText) {
                const scrollY = window.scrollY;
                parallaxText.style.transform = `translateY(${scrollY * 0.5}px)`;
            }
        });

        // Guestbook logic
        const rsvpForm = document.getElementById('rsvp-form');
        const rsvpMessage = document.getElementById('rsvp-message');
        const guestMessages = document.getElementById('guest-messages');
        const messagesCollectionPath = `/artifacts/${appId}/public/data/guestbook`;

        const loadGuestMessages = () => {
            if (!db) {
                console.error("Firestore is not initialized.");
                return;
            }
            const q = query(collection(db, messagesCollectionPath), orderBy('timestamp', 'desc'));
            onSnapshot(q, (querySnapshot) => {
                guestMessages.innerHTML = '';
                querySnapshot.forEach((doc) => {
                    const data = doc.data();
                    const messageElement = document.createElement('div');
                    messageElement.classList.add('p-4', 'bg-gray-100', 'rounded-lg', 'shadow-sm', 'border-l-4', 'border-dusty-rose-dark');
                    messageElement.innerHTML = `
                        <p class="font-semibold text-dusty-rose-dark">${data.nama}</p>
                        <p class="text-sm text-gray-500">${data.kehadiran === 'hadir' ? 'Akan Hadir' : 'Tidak Hadir'}</p>
                        <p class="mt-2 text-gray-700">${data.pesan}</p>
                    `;
                    guestMessages.appendChild(messageElement);
                });
            }, (error) => {
                console.error("Error fetching documents: ", error);
            });
        };

        if (rsvpForm) {
            rsvpForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const nama = document.getElementById('nama-rsvp').value;
                const kehadiran = document.getElementById('kehadiran').value;
                const pesan = document.getElementById('pesan-rsvp').value;

                if (!db || !userId) {
                    console.error("Firestore or user not ready.");
                    // Tampilkan pesan error ke user jika perlu
                    return;
                }
                
                try {
                    await addDoc(collection(db, messagesCollectionPath), {
                        nama: nama,
                        kehadiran: kehadiran,
                        pesan: pesan,
                        timestamp: new Date()
                    });
                    
                    rsvpMessage.classList.remove('hidden');
                    setTimeout(() => {
                        rsvpMessage.classList.add('hidden');
                    }, 3000);
                    rsvpForm.reset();
                } catch (error) {
                    console.error("Error adding document: ", error);
                    // Tampilkan pesan error ke user jika perlu
                }
            });
        }
    </script>
</body>
</html>
